---
title: Three ways to add a newsletter to your blogdown website
author: Francisco Yir√°
date: '2021-11-11'
slug: newsletters-blogdown
cover: "images/cover_newsletter.jpg"
useRelativeCover: true
categories:
  - data-science
  - rmarkdown
  - tutorial
tags:
  - blogdown
  - mailchimp
  - buttondown
  - newsletter
---

This post it's a bit *meta* (in the sense of talking about the blog in the blog itself), but I wrote it anyway because when looking for tutorials about how to implement my own newsletter, I found very few resources: I had to figure out by myself how to do it by trial and error, and adapting instructions that hadn't `hugo`/`blogdown` in mind.

I would like those who want to do the same to have things easier. That's why I will explain here, step by step, **three different ways to implement a newsletter in a `blogdown` website**. These three ways differ regarding **difficulty level** and in how much **automation and customization** they allow.

Since this is a step-by-step tutorial, the full article it's quite long. My recommendation is NOT to read the whole thing but to decide which of these methods it's a better fit for your needs and then jump to the section in which that method is explained.

These three methods are:

1.  [Method 1: manual newsletter with Buttondown]. By using this method, we will have to manually write a mail to our subscribers each time we publish a new blog post. On the upside, the setup is much easier than the other two methods.
2.  [Method 2: automated newsletter with MailChimp, without segmentation]. This method consists in creating an automation based on the RSS feed of the blog, in order to automatically send a mail to the subscribers each time that a new article is published. 
3.  [Method 3: automated and segmented newsletter with MailChimp]. Similar to method 2, but allowing subscribers to self-select themselves on different subscription lists, based on topic or language (e.g. choose to only receive posts about Data Science in Spanish). It's more complex than method 2, since it requieres to create a different automation for each segment/distribution list, identify specific RSS feeds for each segment, and make additional adjustments in MailChimp's audience manager.

Below you can see a summary table with the advantages and disadvantages of each of these three methods.

![](images/summary_ways_adding_newsletter.png)
It's worth mentioning that all these three methods offer proper signup forms, so there is no difference between them in that regard.

Also, note that **method 1, the simpler one, has support for subscriber segmentation**, while method 2 does not. The trap here is that method 1 offers just a *manual* segmentation, in the sense that we will have to manually write the e-mails for each segment (they won't be automatically generated and sent as we publish content in the blog).

Finally (before moving on to the tutorials), I'd like to add a couple of considerations:

 -   There are a lot of `hugo` themes with different features/functionality, and in some of them, the steps shown here may require a bit of adaptation. But in most cases, everything should work very much the same (ü§ûüèº).
 
-  **My intention with this article is not to write an exhaustive revision of all the available methods for implementing a newsletter in blogdown** (that would be an ebook, not a blogpost). If you search the web you'll probably find many other newsletter services that could be integrated with blogdown, and some of them may even be easier to use and/or more feature-rich than those shown here. I just wanted to share with the community the methods that I found while setting up my own newsletter, in order to make things easier for those trying to do the same.

-  This article doesn't assume previous knowledge about Buttondown or MailChimp, but **it does assume that you have a good understanding of blogdown**, that is, that you know how to create and customize a website using this package. If that's not your case, you can find an excellent introduction to this topic in the book [*blogdown: Creating Websites with R Markdown*](https://bookdown.org/yihui/blogdown/).

-  This is an opinionated article. When I decided to create a newsletter, I had a very clear idea of how I wanted it, so the methods that I found (and that I'm sharing here) are biased towards that idea.

And without further ado, let's go to the tutorials themselves.

## Method 1: manual newsletter with Buttondown

If you have a blogdown website as a side-project and you only publish there once in a while (once per month or less), then *maybe* it's not necessary to have an automated newsletter, and you can afford the nuisance of manually writing mails to announce your blogposts to your subscribers.

If this idea sounds okay to you, then maybe [Buttondown](https://buttondown.email/), a simple and easy to use newsletter service, it's the right option for your website.

Below I'll explain how to use this service:

### Step by step

#### Step 1: Create an account and set up the newsletter

You can create a Buttondown account from [here](https://buttondown.email/login). Then, you'll be redirected to another page where you can set up your newsletter. There, you have to indicate the title, description, and, if you want, activate some optional features (such as having an archive or RSS feed for the mails that you will send)[^1].

[^1]: Almost all the options that you would need for a basic newsletter are free. Still, there are a few that are paid, such as removing the Buttondown logo from the mails. 


![*The configuration page of the Buttondown newsletters looks like this. This page will appear right after you create your account.*](images/buttondown_setup.png){width="650"}

Finally, on this page, you can import subscribers by loading a CSV file with mail addresses. This is useful if you're migrating a newsletter from another platform, or if you already have a list of people who are interested in your newsletter.

![](images/import_subscribers_buttondown.png "Importing subscribers in Buttondown"){width="450"}

#### Step 2: implement the subscription form

Once you've created an account and configured the newsletter, you need to set up a way for people to subscribe. In Buttondown you can do this on the section ["Embedding & sharing"](https://buttondown.email/share), which can be found in the main menu (upper-left corner of the screen).


![](images/embed_share_buttondown.png "Embedding and sharing in Buttondown"){width="450"}

Once there, you can choose between two types of signup forms:

-   **Form hosted in Buttondown.email**, with a permanent URL which you can share or link from your blog ([here is an example](https://buttondown.email/franciscoyira)). This is the easiest option: you just have to take the URL and create a link from a visible place in your blog (e.g. the navigation bar).

- **HTML/iFrame embeddable form**. This option allows people to signup right into your blog without having to go to an external URL. If you choose this option, **I would recommend the HTML form instead of the iFrame one**. To implement the HTML form, you have to go to the tab *‚ÄúShare as a form‚Äù*, then copy the HTML code shown there, and finally paste it in a `.md` file inside the content folder in the repo of your blog (usually this folder is literally named `/content`, and you can find it in the root directory of your blogdown repo).

[![](images/html_form_buttondown.png "Code that you have to copy to implement an embedded signup form with Buttondown. You can click on the image to view it in full size."){width="750"}](images/html_form_buttondown.png)

Afterwards, you should ensure that the `.md` page with the embedded form is accessible from the blog navigation. An easy way to do this is to add the page to the blog navigation bar (which can be configured on the `config.toml` file).

I would recommend naming the page with the embedded form as `subscribe.md`. In doing so, this page will get an URL like `baseURL/subscribe` (where `baseURL` is the URL that leads to the blog homepage). An URL like this it's easy to remember and to share with others.

An important detail about embedded forms is that sometimes **they won't load on your website due to a restriction in hugo's rendering engine**. If you find yourself with this problem, you can solve it by adding the following code snippet at the end of the `config.toml` file.

``` {eval="FALSE"}
[markup]
  [markup.goldmark]
    [markup.goldmark.renderer]
      unsafe = true
```

#### Step 3: We're done! Let's send emails (manually)

Once you've set up your newsletter and uploaded a list with subscribers (and/or got a couple of new subscribers through the signup form), **you can start sending emails right away**.

For doing so, go to Menu -\> option *‚ÄúWrite‚Äù* (or directly to  [buttondown.email/emails](buttondown.email/emails)). Then just write the mail announcing a new blogpost and press the ‚ÄúSend‚Äù button. You can even schedule the mail to be sent later.

![](images/escribir_correo_buttondown.png "In this section you can write your newsletter's emails"){width="750"}

#### Bonus: enable tags (i.e. segmentated subscriber lists)

An interesting feature included in Buttondown is allowing to segment the audience using *tags*. That is, classify your subscribers with different tags in order to send some emails only to people who have a specific tag attached.

![](images/tags_idioma_buttondown.png "Using tags to implement a multilingual newsletter in Buttondown"){width="750"}

A use case for the tag feature is creating a **multilingual newsletter**. This can be done by classifying your subscribers based on their language of preference, and then sending emails to each tag according to that language choice.

Even better, you can set up different signup forms in such a way that the tags are automatically applied based on which form the subscriber used. To achieve this, you first have to create the appropriate tags and then return to step 2, where you'll see a new option to pick a tag to associate or link with the form you're creating.

This kind of workflow works very well in tandem with the [multilingual features of hugo and blogdown](https://www.rstudio.com/resources/rstudioglobal-2021/an-easy-and-friendly-way-to-build-your-multilingual-website/), because they allow you to have a different subscription page for each language in your website. That means that for each language you can embed a distinct signup form linked to the corresponding tag.

### Buttondown's limitations

An argument against using Buttondown is that **it makes very difficult to set up a newsletter that automatically delivers the content of new blog posts as they're published**. When you use this service, you almost have no choice but to manually write a new mail each time you want to announce a new blog post.

If you *really* wanted to have an automated newsletter in Buttondown, you would have to connect it with Zapier (an external service, which in many circumstances ends up asking you to pay). When I tried to do this, the resulting automated newsletter was neither well-formatted nor included images.

Maybe it's possible to find solutions to these problems by doing additional research, but if you are sure you want an automated newsletter, then I think **MailChimp is better suited to your needs**. That's why we're going to use it in method 2.

## Method 2: automated newsletter with Mailchimp, without segmentation

Now we'll see how to use MailChimp to set up a newsletter that automatically notifies your subscribers each time you publish a new blog post, without you having to write mails manually. 

Since MailChimp is more complex to use than Buttondown, I'll try to keep this section easy to follow by focusing on the most basic use case: **a unique distribution list delivering all your blog posts**. Later on (in method 3), I'll cover the case of several segmented distribution lists (comparable to Buttondown's tags) to send articles in different languages or about different topics according to your subscribers' preferences.

Another thing to keep in mind is that if you use MailChimp, **the newsletter content will be the same as the content of your blog's [RSS feed](https://es.wikipedia.org/wiki/RSS)**. If your blog has RSS feeds with full content, then subscribers will receive full blog posts in each mail. If not, mails will only display a brief excerpt with the beginning of each article, and subscribers will have no choice but to go to your blog to continue reading[^2].

[^2]: This blog post will not cover the instructions to enable full RSS feeds in blogdown because they heavily depend on the version of hugo and the template that you're using, so I would be risking writing something that's doesn't work in many blogdown settings. If you want to activate this option in your blog, I would recommend these links as a starting point:  [(1)](https://randomgeekery.org/post/2017/09/full-content-hugo-feeds/) , [(2)](https://coolbutuseless.bitbucket.io/2018/02/07/blogdown-rss-feed-of-full-articles/), [(3)](https://stackoverflow.com/questions/48997278/how-do-i-get-my-blogdown-blog-on-r-bloggers/#) and [(4)](https://www.rockyourcode.com/til-how-to-create-full-text-rss-feed-for-hugo/).

### Step by step

#### Step 1: Sign up on MailChimp (and provide a physical address)

Just like on Buttondown, the first step for using MailChimp is [creating an account](https://login.mailchimp.com/signup/). However, here we have an additional thing to worry about: since MailChimp is more focused on "professional" emailers, it asks us to **provide a physical address** in order to comply with anti-spam laws that require such information from those who send automated emails to a lot of people.

This address will then appear by default at the footer of sent emails and in some forms of the subscription flow (for example, when a subscriber changes their preferences). It's possible to [hide this address in some places](https://www.denisejoanne.com/remove-address-from-mailchimp-footer-confirmation/) but not everywhere, so there will always be some pages that publicly display it. 

**What can we do about this?** It's natural to feel uncomfortable with sharing our physical address, but if we don't write anything in this field, then MailChimp doesn't allow us to continue. 

[MailChimp's official recommendations](https://eepurl.com/dyikOT) to avoid sharing our home address are the following:

- Give the address of our university in case of being students or being affiliated with an academic institution.

- Give the address of our workplace (or a cowork space or a studio).

- Pay for a P.O. Box and use that address.

In general, **any address where you can receive and pick up physical mail will be a valid option** that will comply with anti-spam regulations.

[VOY AC√Å]

Adem√°s de la disyuntiva de la direcci√≥n f√≠sica, al registrarnos en MailChimp tambi√©n debemos escoger el plan a contratar (aqu√≠ el gratuito deber√≠a ser suficiente si la lista de suscripci√≥n es peque√±a), y un "Nombre del negocio", que deber√≠a ser el nombre de nuestro sitio web o blog.

![*Los planes que ofrece MailChimp. Si reci√©n estamos empezando nuestro newsletter, el plan gratuito deber√≠a ser suficiente.*](images/planes_mailchimp.png)

Finalmente (e igual que en Buttondown), se muestra una opci√≥n para importar direcciones de correo, √∫til si es que estamos migrando un newsletter existente. En caso contrario se puede omitir.

Y listo, con eso finaliza el registro y podemos avanzar al paso 2.

#### Paso 2: Obtener la URL del feed RSS del blog

Para poder enviar los posts de forma autom√°tica a tus suscriptores es necesario contar con un feed RSS que se actualice cada vez que se publica un nuevo art√≠culo.

La mayor√≠a de los templates de `hugo` usados para `blogdown` entregan soporte nativo para RSS, disponibilizando un feed con los blogposts en una URL de este tipo:

`baseURL/post/index.xml`

Donde `baseURL` corresponde a la URL que nos lleva a la p√°gina principal del blog, y `post` es el nombre de la carpeta que contiene los art√≠culos en el repositorio del blog, y usualmente ubicada dentro de [`~/content`](https://bookdown.org/yihui/blogdown/content.html). Por ejemplo, en este blog la `baseURL` es `franciscoyira.com/es` y el feed con los posts es `franciscoyira.com/es/post/index.xml`.

En otros templates de blogdown esta carpeta puede tener otro nombre, pero el rasgo distintivo que permite identificarla es que **dentro de ella se guardan los art√≠culos del blog** (archivos en formato `.Rmd`, `.Rmarkdown` o `.md`). A veces el nombre de esta carpeta est√° especificado en un archivo `config.toml` en el directorio ra√≠z del repositorio[^3].

[^3]: Alternativamente tambi√©n se puede usar este feed: `baseURL/index.xml`. Pero este incluir√° tambi√©n las p√°ginas de primer nivel, tales como "Acerca de", "Cont√°ctame", etc. , y tambi√©n las p√°ginas de otras secciones, si es que las hay (por ejemplo, si hay una secci√≥n "Portafolio", este feed incluir√° tambi√©n las p√°ginas dentro de ella). Lo m√°s probable que NO queramos que estas p√°ginas se env√≠en como newsletter. Por eso mi sugerencia es **buscar un feed que contenga √∫nicamente los posts o art√≠culos**.

![*Feed RSS de mi blog previsualizado con The RSS Aggregator*](images/feed_the_rss_aggregator.png)

Una vez obtenida la URL del feed RSS puede ser buena idea **previsualizarla** para as√≠ validar su contenido. Para ello se pueden usar opciones como estas:

-   [RSS Viewer](https://codebeautify.org/rssviewer): una herramienta web en la cual se ingresa la URL del feed y se obtiene una vista HTML de este.

-   [The RSS Aggregator](https://chrome.google.com/webstore/detail/the-rss-aggregator/ffhafkagcdhnhamiaecajogjcfgienom): un lector RSS disponible como extensi√≥n para Chrome y Edge (Chromium). Al instalarlo podremos visualizar los feeds RSS directamente en el navegador.

-   [Feedly](https://feedly.com/): un lector RSS disponible como servicio web. Es muy completo y popular pero requiere crear una cuenta.

[LLEGAR AC√Å]

#### Paso 3: Crear el newsletter automatizado a partir del feed RSS

Ya con la URL del feed RSS en mano, procedemos a crear la automatizaci√≥n de MailChimp para enviar un correo cada vez que se publique un nuevo art√≠culo.

Para ello hay que ir a [esta p√°gina](https://mailchimp.com/features/rss-to-email/) y hacer clic en el bot√≥n **"Turn On RSS-to-Email"**.

![](images/turn_on_rss_to_email.png)

Luego aparecer√° una vista como esta, donde se le debe asignar un nombre a la "campa√±a" (***"Campaign Name"***). Este nombre es interno y tiene como fin distinguir este env√≠o recurrente de otros env√≠os (manuales o automatizados) que implementemos en el futuro.

![](images/share_blog_updates.png)

Presionamos "Begin", y en la siguiente p√°gina hay que **ingresar la famosa URL del feed RSS** obtenida en el paso anterior. Adem√°s, se puede configurar a qu√© hora se enviar√°n los correos automatizados[^4]. Si todo est√° OK, hay que presionar **"Next"** en la esquina inferior derecha.

[^4]: Notar que se enviar√°n correos nuevos en esos d√≠as/horas **s√≥lo si existe contenido nuevo desde el env√≠o anterior**, en caso contrario no se enviar√° nada. Por otro lado, si se desactivan algunos d√≠as y se publica un art√≠culo ah√≠, Mailchimp tendr√° que esperar hasta el siguiente d√≠a con env√≠os habilitados para poder enviar el newsletter. Por ello, mi recomendaci√≥n aqu√≠ ser√≠a dejar intacta la opci√≥n por defecto, que es intentar enviar correos todos los d√≠as.

![](images/step1_newsletter_general.png)

En la siguiente pantalla hay que **seleccionar la audiencia a la que le llegar√° el newsletter**. Aqu√≠ dejaremos el valor por defecto (*"Entire audience"*) ya que estamos creando un newsletter √∫nico (no segmentado) para todos los suscriptores[^5].

[^5]: Ya en la siguiente secci√≥n explicar√© los cambios necesarios para introducir segmentaci√≥n en el newsletter, pero por ahora estoy intentando explicar el proceso de la forma m√°s simple posible.

![](images/step_select_audience.png)

Luego de presionar **"Next"** aparecer√° la secci√≥n de "Informaci√≥n de campa√±a", donde se pueden personalizar otros par√°metros del newsletter.

[MILESTONE: 40%]

![](images/campaign_info_es.png)

El primer campo (***"Campaign name"***) corresponde al mismo "nombre de campa√±a" que ingresamos en la primera parte del asistente, y que es solo de uso interno.

El segundo campo (***"Email subject"***) s√≠ es relevante para los suscriptores: es el **t√≠tulo o asunto de los correos que recibir√°n**. Aqu√≠ es posible usar los llamados ["*merge tags*" de MailChimp](https://mailchimp.com/help/rss-merge-tags/): variables que son reemplazadas por atributos provenientes desde el feed RSS, o del gestor de audiencias de MailChimp (por ej, el nombre o apellido de cada suscriptor, o la fecha de publicaci√≥n del art√≠culo). En mi caso, uso el tag `*|RSSITEM:TITLE|*` que corresponde al **t√≠tulo de cada nuevo art√≠culo**.

El tercer campo (***"Preview text"***) corresponde al fragmento que aparece debajo del asunto en las apps de correo electr√≥nico.

![*As√≠ se ve el "Preview text" en las apps de correo electr√≥nico. Fuente: [benchmarkemail.com](https://kb.benchmarkemail.com/en/what-is-preview-text-and-how-can-it-benefit-my-email/)*](images/previewtext01.png)

No logr√© encontrar un merge tag √∫til para personalizar el *preview text*, as√≠ que opt√© por un mensaje est√°tico: "*Abre este correo para leer el art√≠culo completo*", pensando en incrementar la tasa de apertura del newsletter.

Los √∫ltimos 2 campos de esta secci√≥n corresponden al **remitente**: el nombre (***"From name"***) y correo (***"From email address"***) que aparecer√°n en el "De:" o "From:" cuando los suscriptores reciban el newsletter. Aqu√≠ la idea es usar algo f√°cilmente reconocible para evitar que los suscriptores se confundan y piensen que es spam.

M√°s abajo en la misma p√°gina hay algunas opciones adicionales, pero que pueden dejarse con sus valores por defecto sin modificar.

A continuaci√≥n presionamos **Next** y pasamos a la siguiente secci√≥n: **escoger la plantilla para el newsletter**. En esta secci√≥n mi recomendaci√≥n es elegir *"1 Column"* o *"Simple Text"*, que tienen lo justo y necesario para que nuestros posts se muestren correctamente. Para este tutorial elegir√© *"Simple Text"*.

![*Las plantilla b√°sicas "1 Column" y "Simple Text" son buenas opciones para un Newsletter de blogposts.*](images/select_template_es.png)

Habiendo seleccionado la plantilla, aparecer√° la vista de **Dise√±o (*"Design"*)** donde hay que hacer algunos cambios para que el newsletter funcione de manera adecuada.

![*As√≠ luce la vista de Dise√±o del newsletter luego de haber escogido la plantilla "Simple Text"*](images/design_mail_start_es.png)

En particular, debemos insertar una serie de *merge tags RSS* para que contenido del newsletter se alimente de los nuevos posts del blog.

Para m√≠, la forma m√°s sencilla de hacer esto fue **borrar todos los bloques que vienen con la plantilla**, e **insertar 3 nuevos bloques de texto** (*"Text"* desde la galer√≠a de contenido de la derecha). Luego seleccion√© y edit√© estos bloques, e insert√© ah√≠ los merge tags correspondientes.

A continuaci√≥n describo cada uno de estos bloques (junto al c√≥digo HTML para replicarlos):

Primero, un **bloque de cabecera**, muy simple, en un tama√±o de letra peque√±o y con un link directo al post en el blog. ¬øPor qu√©? Debido a que a veces los clientes de correo no muestran correctamente el contenido de los newsletters y en estos casos queremos que el lector pueda ir f√°cilmente al art√≠culo original usando un navegador web[^6].

[^6]: Por ejemplo, [Microsoft Outlook Desktop utiliza ¬°Word! como visor de HTML](https://medium.com/@brentonhenry/its-2019-and-outlook-is-still-rendered-with-word-675ca1a5d1a0#:~:text=Outlook%20renders%20your%20email%20using%20Word.%20Yes%2C%20the,in%20the%20%E2%80%9CEnterprise%E2%80%9D%20Standard%20product%20that%20is%20Outlook.), y a la vez es una aplicaci√≥n muy utilizada en empresas, por lo que es casi seguro que alguno de nuestros suscriptores recibir√° el newsletter ah√≠ y tendr√° una mala experiencia si no lo redirigimos a un navegador web a leer el art√≠culo.

El HTML para este bloque es el siguiente:

`<span style="font-size:12px"><a href="*|RSSITEM:URL|*" target="_blank">Ver el post en tu navegador</a>&nbsp;(recomendado).</span>`

Y deber√≠a verse as√≠ en el panel de la izquierda:

![](images/cabecera_es.png)

N√≥tese la presencia del merge tag `*|RSSITEM:URL|*` en el link. Este merge tag se reemplazar√° por la URL correspondiente al post en cada env√≠o del newsletter.

Luego viene un **bloque de contenido**, cuyo c√≥digo es el siguiente:

    <h2 class="mc-toc-title"><span style="font-family:helvetica neue,helvetica,arial,verdana,sans-serif"><a href="*|RSSITEM:URL|*" target="_blank">*|RSSITEM:TITLE|*</a></span></h2>
    <span style="font-family:helvetica neue,helvetica,arial,verdana,sans-serif">*|RSSITEM:CONTENT_FULL|*</span>

    <pre>
    <span style="font-family:helvetica neue,helvetica,arial,verdana,sans-serif">*|END:RSSITEMS|*</span>
    </pre>

Y deber√≠a verse as√≠ en el panel de la izquierda:

![](images/content_block_es.png)

Y finalmente un **bloque *footer***, con elementos obligatorios como la licencia del contenido y el link de desuscripci√≥n. El c√≥digo que us√© para este bloque es el siguiente:

    <em>Este trabajo est&aacute; licenciado bajo &nbsp;<a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>.</em><br />
    <br />
    *|LIST:DESCRIPTION|*<br />
    <br />
    &iquest;Quieres cambiar como recibes estos e-mails?<br />
    Puedes <a href="*|UPDATE_PROFILE|*">actualizar tus preferencias</a> o <a href="*|UNSUB|*">desuscribirte de esta lista</a>.<br />
    <br />
    *|REWARDS|*

Y deber√≠a verse as√≠ en el panel de la izquierda:

![](images/footer_block_es.png)

Por supuesto, en este √∫ltimo bloque deber√≠as modificar la parte de la licencia en caso de que quieras usar una distinta a [CC 4.0](https://creativecommons.org/licenses/by/4.0/).

Notar que MailChimp ofrece un editor visual para los bloques de texto, por lo que *t√©cnicamente* no es necesario manipular HTML: los merge tags se pueden insertar "tal cual" en este editor visual, y su formato (fuente, tama√±o) se puede modificar desde ah√≠. Pero yo **prefiero compartirles los bloques de c√≥digo porque as√≠ es m√°s f√°cil seguir las instrucciones**: solo basta copiar y pegar. Una vez copiados los bloques se puede cambiar sin problemas al editor visual para seguir personaliz√°ndolos.

Y listo, habiendo ya dise√±ado y personalizado el newsletter podemos echarle un vistazo a como lucir√° en las bandejas de entrada de nuestros suscriptores ‚ú®. Para esto existe el men√∫ *"**Preview and Test**"* en la esquina superior derecha, dentro de la misma secci√≥n *Design*. Este men√∫ permite previsualizar un correo de prueba en la web de MailChimp o en la aplicaci√≥n m√≥vil, e incluso enviarnos un correo de prueba a nosotros mismos (o a amigos dispuestos a ser conejillos de indias).

![](images/previsualizacion_modos.png)

Una vez conformes con c√≥mo se ver√° el newsletter presionamos ***"Next"*** y avanzamos al √∫ltimo paso de esta secci√≥n: **Confirmar que todo est√© OK y dar luz verde a los env√≠os autom√°ticos**.

![](images/confirm_nresletter_es.png)

En esta p√°gina se puede dar un √∫ltimo vistazo a las opciones del env√≠o, y volver atr√°s si es que aun queremos cambiar algo. Si todo nos parece bien, hay 2 opciones para que el newsletter empiece a operar:

-   ***Start RSS*** (bot√≥n abajo a la derecha): pone en marcha la automatizaci√≥n, pero a partir del pr√≥ximo post que se publique en blog. Es decir, **no se enviar√° nada al momento de presionarlo**, pero s√≠ cuando publiquemos nuevos art√≠culos en el futuro.

-   ***Send now and Start RSS campaign*** (disponible al hacer clic en flecha al lado de *"Start RSS"*): tambi√©n pone en marcha la automatizaci√≥n, pero realiza de inmediato un primer env√≠o con el √∫ltimo post disponible en el blog.

Hay que elegir una de las 2 opciones y presionar el bot√≥n correspondiente, ¬°y listo! Nuestro newsletter automatizado ya est√° funcionando.

Pero a√∫n falta una parte muy importante: implementar el formulario de suscripci√≥n para que nuevos lectores puedan darse de alta.

#### Paso 4: Implementar el formulario de suscripci√≥n

Mientras que en Buttondown el formulario de suscripci√≥n viene configurado por defecto y sin muchas opciones de personalizaci√≥n, en MailChimp se nos da la posibilidad de **dise√±arlo nosotros mismos**. El proceso de dise√±o es relativamente sencillo ya que contamos con un editor visual: para acceder a √©l solo hay que ir a ***Audience \> Signup forms*** y ah√≠ hacer clic en **"Form Builder"**.

![](images/form_builder_es.png)

Lo primero que veremos dentro del editor visual ser√° el **formulario de suscripci√≥n predeterminado de MailChimp**. Este incluye el campo de correo electr√≥nico, que es el √∫nico estrictamente necesario, y tambi√©n otros como fecha de nacimiento, nombre, y apellido. Depende de nosotros cu√°les de estos campos adicionales conservar y cu√°les eliminar.

Para eliminar un campo hay que seleccionarlo y luego presionar ***"Delete"*** en la parte inferior del panel de la derecha. Se nos mostrar√° una advertencia ya que eliminar el campo implica tambi√©n eliminar los datos vinculados a este (en el gestor de audiencias de MailChimp). Si ya hay datos asociados a este campo puede convenir simplemente ocultarlo (opci√≥n tambi√©n disponible en el panel de la derecha).

Adem√°s, se pueden agregar campos nuevos para recolectar informaci√≥n adicional. Esto lo usaremos en la siguiente secci√≥n para implementar los newsletters segmentados, pero para el newsletter simple nos basta y sobra con el campo de correo electr√≥nico.

![*As√≠ se ve un formulario simple (s√≥lo con un campo de correo) dentro del editor visual de MailChimp.*](images/subscription_form.png)

Una vez personalizado el formulario de suscripci√≥n tenemos 2 opciones para agregarlo a nuestro blog:

1.  La m√°s simple: **usar el enlace directo al formulario de suscripci√≥n**. Este enlace apunta a un formulario alojado en MailChimp que luce id√©ntico al dise√±ado/previsualizado en el editor visual. Este se puede obtener en la secci√≥n ***"Signup form URL"*** dentro del editor visual de formularios. Con esta URL se puede crear un link desde cualquier lugar visible del blog (por ej., la barra de navegaci√≥n).

    ![](images/get_url_signup.png)

2.  **Incrustar el formulario en nuestro blog mediante c√≥digo HTML**. Esto es m√°s complejo, pero evita que lectores tengan que ir a una URL externa para suscribirse, y adem√°s da al formulario una apariencia m√°s consistente con el resto de nuestro blog.

Para implementar el formulario HTML incrustado hay que volver a *Audience \> Signup forms*, pero ahora entrando en la secci√≥n **"Embedded forms"**.

En esta secci√≥n hay varias opciones de formularios incrustados, algunas con CSS y JavaScript, pero recomendar√≠a usar la opci√≥n *Unstyled*: un formulario HTML b√°sico que reduce la posibilidad de conflicto con el tema del blog.

Luego de seleccionar el formulario *Unstyled* recomiendo adem√°s desactivar la opci√≥n *Include form title*, porque el formulario se incrustar√° en una p√°gina Markdown que ya tiene su propio t√≠tulo.

![](images/get_embeded_form1-01.png)

Es importante mencionar que los campos de este formulario y los del formulario que dise√±amos en el editor visual son los mismos. **No estamos creando un formulario distinto**, sino que usando otra forma de acceder a √©l.

Luego de configurar las opciones, hay que ir al final de la p√°gina y presionar el bot√≥n **"Generate Embed Code"**.

![](images/get_embed_form2.png)

Se debe copiar el c√≥digo que aparecer√° ah√≠, y pegarlo en el archivo `.md` correspondiente (aquel donde queremos que se muestre el formulario de suscripci√≥n). El c√≥digo debe ir debajo de la cabecera YAML (en mi caso agregu√© tambi√©n un peque√±o texto explicativo entre la cabecera y el formulario).

![](images/paste_embed_code_mailchimp.png)

Al hacer *knit* del blog, la p√°gina con el formulario de suscripci√≥n deber√≠a lucir as√≠:

![](images/embed_form_inblog.png)

*¬°Y listo!* Aqu√≠ ya tenemos un formulario de suscripci√≥n totalmente funcional, conectado al newsletter automatizado que creamos en la secci√≥n anterior.

Sin embargo, yo hice 2 ajustes adicionales, totalmente opcionales, que creo que mejoran la apariencia y funcionalidad del formulario.

Primero, **cambiar el estilo del bot√≥n "Subscribe"**. El por defecto no tiene mucha apariencia de bot√≥n, y adem√°s le falta un salto de l√≠nea que lo separe del campo *Email Address*. Para esto hay que buscar este c√≥digo:

``` {.HTML}
<input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
```

Y reemplazarlo por este c√≥digo:

``` {.HTML}
</br> <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" style="height:27px; width:100px; font-size:16px"></div>
```

Segundo, **agregar al final de la p√°gina un link al formulario alojado en MailChimp** (el enlace directo que vimos en la secci√≥n anterior). ¬øPor qu√©? Por la eventualidad de alguien que desee suscribirse pero use alg√∫n bloqueador de contenido (por ej., uBlock Origin) que le impida visualizar el formulario incrustado. Con este link esas personas tendr√°n una forma alternativa de darse de alta en el newsletter.

Para hacer este cambio basta con agregar un texto con el link correspondiente *despu√©s* de que termine el c√≥digo del formulario incrustado (es decir, despu√©s de esta l√≠nea: `<!--End mc_embed_signup-->`).

Al hacer estos cambios la apariencia del formulario quedar√° as√≠:

![](images/embeded_form_v2-01.png)

## M√©todo 3: newsletter automatizado y segmentado con MailChimp

Estamos llegando a la parte final de este tutorial. Si sigues leyendo hasta aqu√≠ es porque no te basta con tener un √∫nico newsletter con todo el contenido de tu blog, sino que deseas tener **varias listas de distribuci√≥n, segmentadas por idioma, por tema, o ambas**.

Para no extender tanto este art√≠culo (que ya esta siendo bastante largo), aqu√≠ no har√© una explicaci√≥n "paso por paso" como en secciones anteriores, sino que **ser√° una especie de anexo de la secci√≥n anterior** (m√©todo 2), mostrando qu√© cosas hay que hacer distinto para obtener un newsletter segmentado (eso implica que si saltaste directo desde la introducci√≥n hasta ac√°, tendr√°s que subir y leer primero la parte del m√©todo 2, lo siento üòÖ).

### Conseguir los feed RSS espec√≠ficos para cada tema y/o idioma

El primer cambio necesario para tener listas de distribuci√≥n segmentadas es **usar feeds RSS espec√≠ficos** con el contenido que recibir√° cada segmento.

Ilustrar√© esto con un ejemplo de este mismo blog: aqu√≠ implement√© listas de distribuci√≥n exclusivas para el contenido de Data Science, una en ingl√©s y otra en espa√±ol. Para esto fue necesario obtener 2 feeds RSS:

1.  Feed con el contenido de Data Science en ingl√©s

2.  Feed con el contenido de Data Science en espa√±ol

Al tener un sitio multiling√ºe con `blogdown` es muy sencillo obtener feeds RSS espec√≠ficos para cada idioma: basta con **agregar el c√≥digo del idioma** (por ej., *es*, *fr*, *en*) **justo despu√©s de la `baseURL`**. En el caso de este blog los feeds con contenido en espa√±ol e ingl√©s son los siguientes:

-   Espa√±ol: `franciscoyira.com/es/post/index.xml`

-   Ingl√©s: `franciscoyira.com/post/index.xml`

Donde `franciscoyira.com` corresponde a la `baseURL`. Notar el sufijo `es/` en el feed en espa√±ol (en el feed en ingl√©s no hay sufijo porque [est√° configurado como el idioma "base" del blog](https://github.com/franciscoyira/personalblog_hugo/blob/8ad38636ed080424babeef37d15d3eca344d0815/config.toml#L2)).

OK, ah√≠ ya tenemos una regla para obtener los feeds correspondientes a cada idioma, pero ¬øc√≥mo obtener un feed que tenga s√≥lo los posts sobre Data Science (o cualquier otro tema)?

Para esto debemos usar la **estructura de tags y categor√≠as** de nuestro blog. En mi caso simplemente cre√© una categor√≠a denominada `data-science` y empec√© a marcar todos los posts de Data Science con esta categor√≠a.

Aqu√≠ entra la magia de `hugo`, que autom√°ticamente genera p√°ginas para cada tag y categor√≠a. En el caso de este ejemplo, se generaron las siguientes p√°ginas con los posts de la categor√≠a `data-science`:

`franciscoyira.com/es/categories/data-science/` para los posts en espa√±ol, y...

`franciscoyira.com/categories/data-science/`¬†para los posts en ingl√©s.

Y como vimos en la secci√≥n anterior, `hugo` tambi√©n crea autom√°ticamente feeds RSS para las p√°ginas de este tipo. **Para acceder a estos feeds simplemente hay agregar el sufijo `index.xml` al final**, por lo que los feeds de la categor√≠a `data-science` ser√°n estos:

`franciscoyira.com/es/categories/data-science/index.xml` para los posts en espa√±ol, y...

`franciscoyira.com/categories/data-science/index.xml`¬†para los posts en ingl√©s.

Las instrucciones son muy similares si queremos usar tags en vez de categor√≠as: por lo general bastar√° con reemplazar `categories` por `tags` en las URLs.

Como consideraci√≥n, mencionar que **los tags/categor√≠as en distintos idiomas no tienen por qu√© llamarse igual**, de hecho se configuran por separado y el que aqu√≠ tengan el mismo nombre es solo coincidencia. En mi blog quise que la categor√≠a de Data Science tuviera el mismo nombre en espa√±ol e ingl√©s, pero perfectamente los posts en espa√±ol podr√≠an estar categorizados como `ciencia-de-datos` en cuyo caso la URL del feed ser√≠a as√≠:

`franciscoyira.com/es/categories/ciencia-de-datos/index.xml`

Y esto no afectar√≠a en nada la URL del feed de Data Science en ingl√©s.

#### TL;DR

En resumen, **depende de nosotros mismos crear una estructura de tags o categor√≠as acorde a las listas de distribuci√≥n que queramos tener**. Una vez definida esta estructura, es sencillo obtener las URLs de los feeds RSS correspondientes: basta con encontrar la pagina del tag o categor√≠a respectiva (para lo cual incluso se puede usar la navegaci√≥n del blog) y agregar `index.xml` al final.

Y para especificar un idioma particular (en el caso de blogs multiling√ºes) solo hace falta agregar el c√≥digo de idioma despu√©s de la `baseURL`, siempre que se trate de un idioma distinto del "idioma base".

### Crear segmentos para cada lista de distribuci√≥n

Otro ingrediente necesario para segmentar un newsletter es contar con las respectivos *campos de datos* o *columnas* en el gestor de audiencias de MailChimp, indicando a qu√© segmento pertenece cada suscriptor.

MailChimp ofrece varias formas de crear categor√≠as de suscriptores, y una de ellas literalmente se llama *Segmentos*, pero **la que en realidad nos conviene usar se llama *Grupos*** (es confuso, lo s√©), ya que est√° directamente vinculada con los formularios de suscripci√≥n.

Para crear grupos hay que ir a *Audience \> All Contacts*, ah√≠ seleccionar el men√∫ drop-down **"Manage contacts"** y hacer clic en "Groups".

![](images/create_groups.png)

Dentro de la secci√≥n *"Groups"* hay que presionar el bot√≥n ***"Create Groups"***, a la derecha de la pantalla.

Ah√≠ aparecer√° la siguiente p√°gina de configuraci√≥n, donde se debe ingresar el **nombre** (*Group category*) y **posibles valores** (*Group names*) del grupo a crear. Tambi√©n se debe elegir c√≥mo aparecer√°n estas opciones dentro del formulario de suscripci√≥n (radio buttons, dropdown, checkboxes, etc).

![](images/create_groups2.png)

Aqu√≠ existe mucha libertad para crear distintos arreglos, dependiendo de c√≥mo queremos que sea el flujo para enrolarse en cada lista de distribuci√≥n[^7].

[^7]: Por ejemplo, yo defin√≠ el Idioma como una *Group category* que est√° oculta en los formularios: si te suscribes en el [formulario en espa√±ol](https://www.franciscoyira.com/es/subscribe/) recibir√°s contenido en espa√±ol, y si usas el [formulario en ingl√©s](https://www.franciscoyira.com/subscribe/) recibir√°s contenido en ingl√©s. Pero tambi√©n podr√≠a haber configurado un formulario √∫nico, biling√ºe, donde la opci√≥n de idioma se pudiera escoger desde un *dropdown* o con *radio buttons*.

Para ejemplificar los pasos que vienen despu√©s, replicar√© los mismos grupos que implement√© en mi propio blog, pero ahora usando *radio buttons* para todos ellos:

-   Grupos seg√∫n temas/contenido:

    1.  Todo el contenido: para quienes deseen recibir todos los posts que publique

    2.  S√≥lo Data Science: para quienes deseen recibir exclusivamente los posts con la categor√≠a `data-science`.

-   Grupos seg√∫n idioma:

    1.  Espa√±ol

    2.  Ingl√©s

Para implementar esta segmentaci√≥n hay que dirigirse a la secci√≥n *"Create groups"* ya mencionada y crear los 2 tipos de grupos, escogiendo *As radio buttons...* para ambos.

Hecho esto, la secci√≥n de grupos deber√≠a verse as√≠:

![](images/groups_created.png)

Ahora hay que disponibilizar un formulario que permita elegir entre estos grupos. Para esto, igual que antes, tenemos 2 opciones:

-   **Usar un link directo a un formulario alojado en MailChimp.** Los pasos para hacer esto son id√©nticos que los para el newsletter no segmentado.

-   **Incrustar un formulario en nuestro blog.** Aqu√≠ los pasos son muy similares a los del newsletter no segmentado, con una sola diferencia: dentro de *Audience \> Signup forms \> Embedded Forms \> Unstyled* hay que asegurarse de activar la casilla ***"Show interest group fields"***. Lo dem√°s es todo igual: obtener el c√≥digo HTML y pegarlo en un archivo `.md` de nuestra preferencia, dentro del repositorio del blog.

En ambos casos los grupos creados en el paso anterior se agregar√°n autom√°ticamente al formulario.

Si seguimos la opci√≥n del formulario incrustado, el resultado deber√≠a lucir as√≠:

![](images/form_content_options.png)

Aqu√≠ **ya contamos con un formulario funcional** que permitir√° a los lectores escoger su propia lista de suscripci√≥n en base a idioma e intereses/contenido. *T√©cnicamente* no es necesario hacer nada m√°s y podr√≠an saltar de aqu√≠ a la secci√≥n final del tutorial pero si les gusta rizar el rizo como a mi pueden leer a continuaci√≥n c√≥mo hacer algunas mejoras al formulario incrustado.

#### M√°s personalizaci√≥n para el formulario incrustado

Si hemos optado por el formulario incrustado tenemos la opci√≥n de hacer algunos **ajustes est√©ticos adicionales**.

Para empezar, se pueden aplicar los mismos ajustes mostrados en la secci√≥n de newsletter no segmentado: mejorar el bot√≥n de suscripci√≥n, a√±adir un salto de l√≠nea despu√©s del campo de correo electr√≥nico, y poner un link al formulario en MailChimp al final de la p√°gina (ante la eventualidad de que un bloqueador de contenido no permita visualizar el formulario incrustado).

Adicional a ello, creo que ac√° es buena idea **cambiar los textos descriptivos de los grupos**. Por ejemplo, dado que el formulario de este ejemplo ser√≠a biling√ºe, aumentar√≠a su usabilidad el describir las opciones tanto en ingl√©s como en espa√±ol.

Para lograr esto basta con ir al archivo `.md` donde est√° el formulario, invocar CTRL+F (o ‚åò+F en Mac), buscar el texto que se muestra actualmente en el formulario y cambiarlo por otro nuevo que nos parezca m√°s apropiado. En este caso, aplicar√© los siguientes cambios:

![](images/before_form_personalization.png){width="750"}

![](images/after_form_personalization.png){width="750"}

**Notar que esto no cambia el nombre interno de los campos de datos en el gestor de audiencias de MailChimp**. All√≠ los campos siguen llam√°ndose "*Intereses/contenido"* e "*Idioma"*, y los valores asociados a cada alternativa son las opciones originales que configuramos en MailChimp.

Dicho de otra forma, existe simult√°neamente un "valor interno" y un "valor para mostrar" para cada grupo y opci√≥n. Esto es √∫til ya que permite usar nombres cortos en los valores internos y nombres m√°s largos y explicativos en los "valores para mostrar".

Una vez conformes con la apariencia del formulario, hemos completado el segundo de los requisitos para tener un newsletter segmentado. Ahora vamos a usar estos ingredientes para el paso final: **configurar el newsletter segmentado**.

### Mezclado los ingredientes para crear un newsletter segmentado

Una vez que tenemos las URLs de los feeds RSS, los segmentos de audiencia, y el formulario que permite a los suscriptores escoger su segmento, es hora de combinar todo esto para echar a andar nuestro newsletter segmentado ‚ú®.

![](images/diagrama_es_segmented_newsletter.png)

Lo que hay que hacer aqu√≠ es simplemente **repetir el proceso de crear un newsletter automatizado** (explicado ya en la secci√≥n anterior) para *cada uno* de los segmentos, pero haciendo 2 cambios:

1.  Al momento de ingresar la URL del feed RSS, hay que usar la URL correspondiente al feed del tema/idioma espec√≠fico para el segmento.

![](images/customize_URL_newsletter.png)

2.  En el paso de escoger la audiencia, en vez de seleccionar *Entire audience* hay que elegir *Group or new segment*. Al hacerlo aparecer√° debajo un cuadro para **indicar los criterios que definen la audiencia segmentada**, y los grupos creados en pasos anteriores estar√°n dentro de los criterios disponibles. Por ejemplo, en este caso, se puede segmentar a los suscriptores seg√∫n la opci√≥n de *Idioma* e *Intereses/contenido* que escogieron en el formulario de suscripci√≥n.

![](images/choose_audience-01.png)

¬°Y listo! El resto de los pasos son id√©nticos a los del newsletter sin segmentaci√≥n. Solo recalcar√≠a la necesidad de repetir el proceso con *cada uno* de los segmentos[^8], configurando una automatizaci√≥n distinta para todos ellos.

[^8]: En este ejemplo ser√≠an 4 segmentos, correspondientes a la combinatoria de los grupos de *Idioma* y de *Intereses/contenido*: Todo-Ingl√©s, Todo-Espa√±ol, Data Science-Ingl√©s y Data Science-Espa√±ol.

*Tu feedback es bienvenido. Si tienes comentarios sobre este art√≠culo puedes envi√°rmelos [por correo](mailto:francisco.yira@outlook.com).*

*Por cierto, luego de este art√≠culo retomo [la serie sobre el libro Causal Inference: The Mixtape](https://www.franciscoyira.com/es/tags/causal-inference-the-mixtape/). El pr√≥ximo post estar√° dedicado al [cap√≠tulo 4](https://mixtape.scunning.com/potential-outcomes.html), acerca el modelo causal de Potential Outcomes.*
